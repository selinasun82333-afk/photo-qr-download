<!DOCTYPE html>
<html lang="ko">
  <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Photo Memories - ÏÇ¨ÏßÑ Îã§Ïö¥Î°úÎìú</title>
      <style>
                * {
                              margin: 0;
                              padding: 0;
                              box-sizing: border-box;
                }

                body {
                              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
                              background: linear-gradient(135deg, #fce4ec 0%, #f3e5f5 100%);
                              min-height: 100vh;
                              padding: 40px 20px;
                }

                .container {
                              max-width: 1000px;
                              margin: 0 auto;
                }

                .header {
                              text-align: center;
                              margin-bottom: 60px;
                }

                .logo {
                              width: 120px;
                              height: 120px;
                              margin: 0 auto 30px;
                              background: linear-gradient(135deg, #ff69b4 0%, #ba68c8 50%, #7986cb 100%);
                              border-radius: 30px;
                              display: flex;
                              align-items: center;
                              justify-content: center;
                              font-size: 60px;
                              box-shadow: 0 10px 30px rgba(255, 105, 180, 0.2);
                }

                .title {
                              font-size: 36px;
                              font-weight: 700;
                              color: #333;
                              margin-bottom: 10px;
                              letter-spacing: 2px;
                }

                .subtitle {
                              font-size: 14px;
                              color: #999;
                              letter-spacing: 3px;
                              font-weight: 500;
                }

                .description {
                              font-size: 16px;
                              color: #666;
                              margin-top: 30px;
                              line-height: 1.6;
                }

                .gallery-title {
                              font-size: 20px;
                              color: #333;
                              margin: 50px 0 20px 0;
                              display: flex;
                              align-items: center;
                              gap: 10px;
                }

                .gallery-title::before {
                              content: "üì∑";
                              font-size: 24px;
                }

                .gallery-subtitle {
                              font-size: 13px;
                              color: #999;
                              margin-bottom: 30px;
                }

                .gallery {
                              display: grid;
                              grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                              gap: 20px;
                              margin-bottom: 40px;
                }

                .photo-item {
                              position: relative;
                              aspect-ratio: 1;
                              border-radius: 15px;
                              overflow: hidden;
                              background: #f5f5f5;
                              cursor: pointer;
                              transition: transform 0.3s ease, box-shadow 0.3s ease;
                              box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                }

                .photo-item:hover {
                              transform: translateY(-5px);
                              box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
                }

                .photo-img {
                              width: 100%;
                              height: 100%;
                              object-fit: cover;
                }

                .photo-overlay {
                              position: absolute;
                              top: 0;
                              left: 0;
                              right: 0;
                              bottom: 0;
                              background: rgba(0, 0, 0, 0.4);
                              display: flex;
                              align-items: center;
                              justify-content: center;
                              opacity: 0;
                              transition: opacity 0.3s ease;
                }

                .photo-item:hover .photo-overlay {
                              opacity: 1;
                }

                .download-btn {
                              width: 56px;
                              height: 56px;
                              border-radius: 50%;
                              background: linear-gradient(135deg, #ff69b4 0%, #ba68c8 100%);
                              border: none;
                              cursor: pointer;
                              display: flex;
                              align-items: center;
                              justify-content: center;
                              font-size: 24px;
                              color: white;
                              box-shadow: 0 5px 20px rgba(255, 105, 180, 0.4);
                              transition: transform 0.2s ease, box-shadow 0.2s ease;
                }

                .download-btn:hover {
                              transform: scale(1.1);
                              box-shadow: 0 8px 25px rgba(255, 105, 180, 0.6);
                }

                .download-btn:active {
                              transform: scale(0.95);
                }

                .empty-state {
                              text-align: center;
                              padding: 60px 20px;
                }

                .empty-icon {
                              font-size: 64px;
                              margin-bottom: 20px;
                }

                .empty-title {
                              font-size: 20px;
                              color: #333;
                              margin-bottom: 10px;
                }

                .empty-message {
                              font-size: 14px;
                              color: #999;
                              line-height: 1.6;
                }

                .loading {
                              text-align: center;
                              padding: 40px 20px;
                              font-size: 16px;
                              color: #999;
                }

                .spinner {
                              display: inline-block;
                              width: 40px;
                              height: 40px;
                              border: 4px solid #f3f3f3;
                              border-top: 4px solid #ff69b4;
                              border-radius: 50%;
                              animation: spin 1s linear infinite;
                              margin-bottom: 20px;
                }

                @keyframes spin {
                              0% { transform: rotate(0deg); }
                              100% { transform: rotate(360deg); }
                }

                .footer {
                              text-align: center;
                              padding: 30px 0;
                              color: #999;
                              font-size: 12px;
                              border-top: 1px solid rgba(0, 0, 0, 0.05);
                }

                @media (max-width: 768px) {
                              .title {
                                                font-size: 28px;
                              }

                              .gallery {
                                                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                                                gap: 15px;
                              }

                              .download-btn {
                                                width: 48px;
                                                height: 48px;
                                                font-size: 20px;
                              }
                }
            </style>
  </head>
  <body>
        <div class="container">
                  <div class="header">
                                <div class="logo">üì∏</div>div>
                                <h1 class="title">ÏÇ¨ÏßÑ Ï∂îÏñµ</h1>h1>
                                <p class="subtitle">PHOTO MEMORIES</p>p>
                                <p class="description">ÌäπÎ≥ÑÌïú ÏàúÍ∞ÑÏùÑ Ìï®Íªò Í∞ÑÏßÅÌïòÏÑ∏Ïöî</p>p>
                  </div>div>

                  <div class="gallery-title">Í∞§Îü¨Î¶¨ ÎØ∏Î¶¨Î≥¥Í∏∞</div>div>
                  <p class="gallery-subtitle">Í≥†Í∞ùÏù¥ Î∞õÎäî ÌûêÎìúÏóêÏÑú ÏÇ¨ÏßÑÏù¥ Ïù¥Î†áÍ≤å Î≥¥ÏûÖÎãàÎã§</p>p>

                  <div id="gallery" class="gallery"></div>div>

                  <div class="footer">
                                <p>&copy; 2024 PhotoBooth. All rights reserved.</p>
                  </div>div>
        </div>div>
  
      <script>
                // API ÏÑ§Ï†ï
                const SUPABASE_URL = 'https://aapoucfpswemgshulxrp.supabase.co';
                const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFhcG91Y2Zwc3dlbWdzaHVseHJwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUwMzIyMDAsImV4cCI6MTk5MDYwODIwMH0.CjNKyqn6P64q2r3Y_EjKXYgLgBiJHJHpzspKZ7F_lNI';

                // URLÏóêÏÑú session_slug Ï∂îÏ∂ú
                const urlPath = window.location.pathname;
                const sessionSlug = urlPath.split('/').filter(Boolean).pop() || '22ee2c96';

                const galleryEl = document.getElementById('gallery');

                // ÏÇ¨ÏßÑ Î∂àÎü¨Ïò§Í∏∞
                async function loadPhotos() {
                              try {
                                                galleryEl.innerHTML = '<div class="loading"><div class="spinner"></div><p>ÏÇ¨ÏßÑÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...</p></div>';

                                                const response = await fetch(
                                                                      `${SUPABASE_URL}/rest/v1/photos?session_slug=eq.${sessionSlug}&order_by=sort_order.asc`,
                                                  {
                                                                            headers: {
                                                                                                          'apikey': SUPABASE_ANON_KEY,
                                                                                                          'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                                                                                                          'Content-Type': 'application/json'
                                                                              }
                                                  }
                                                                  );

                                                if (!response.ok) throw new Error('Failed to fetch photos');

                                                const photos = await response.json();

                                                if (photos.length === 0) {
                                                                      galleryEl.innerHTML = `
                                                                                              <div class="empty-state" style="grid-column: 1/-1;">
                                                                                                                          <div class="empty-icon">üì∏</div>
                                                                                                                                                      <div class="empty-title">ÏÇ¨ÏßÑÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§</div>
                                                                                                                                                                                  <div class="empty-message">ÎßÅÌÅ¨Í∞Ä ÎßåÎ£åÎêòÏóàÍ±∞ÎÇò ÏûòÎ™ªÎêú Ï£ºÏÜåÏûÖÎãàÎã§.</div>
                                                                                                                                                                                                          </div>
                                                                                                                                                                                                                              `;
                                                                      return;
                                                }

                                                galleryEl.innerHTML = '';
                                                photos.forEach(photo => {
                                                                      const photoItem = createPhotoItem(photo);
                                                                      galleryEl.appendChild(photoItem);
                                                });
                              } catch (error) {
                                                console.error('Error loading photos:', error);
                                                galleryEl.innerHTML = `
                                                                    <div class="empty-state" style="grid-column: 1/-1;">
                                                                                            <div class="empty-icon">‚ö†Ô∏è</div>
                                                                                                                    <div class="empty-title">Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§</div>
                                                                                                                                            <div class="empty-message">ÏÇ¨ÏßÑÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.</div>
                                                                                                                                                                </div>
                                                                                                                                                                                `;
                              }
                }

                // ÏÇ¨ÏßÑ ÏïÑÏù¥ÌÖú ÏÉùÏÑ±
                function createPhotoItem(photo) {
                              const item = document.createElement('div');
                              item.className = 'photo-item';

                              const imageUrl = `${SUPABASE_URL}/storage/v1/object/public/photos/${photo.file_path}`;

                              item.innerHTML = `
                                              <img src="${imageUrl}" alt="Photo" class="photo-img" loading="lazy">
                                                              <div class="photo-overlay">
                                                                                  <button class="download-btn" onclick="downloadPhoto('${imageUrl}', '${photo.file_name}')" title="Îã§Ïö¥Î°úÎìú">
                                                                                                          ‚¨áÔ∏è
                                                                                                                              </button>
                                                                                                                                              </div>
                                                                                                                                                          `;

                              return item;
                }

                // ÏÇ¨ÏßÑ Îã§Ïö¥Î°úÎìú
                function downloadPhoto(url, fileName) {
                              const link = document.createElement('a');
                              link.href = url;
                              link.download = fileName || 'photo.jpg';
                              link.style.display = 'none';
                              document.body.appendChild(link);
                              link.click();
                              document.body.removeChild(link);
                }

                // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏÇ¨ÏßÑ Î∂àÎü¨Ïò§Í∏∞
                document.addEventListener('DOMContentLoaded', loadPhotos);
      </script>
  </body>
</html>html>
      </script></p>
  </body>
      </style></title>
  </head>
